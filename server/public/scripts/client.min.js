var myApp=angular.module("myApp",["ngRoute","ngMaterial"]);myApp.config(["$routeProvider","$locationProvider",function(a,b){b.hashPrefix(""),a.when("/home",{templateUrl:"/views/templates/home.html",controller:"LoginController"}).when("/register",{templateUrl:"/views/templates/register.html",controller:"LoginController"}).when("/user",{templateUrl:"/views/templates/user.html",controller:"UserController",resolve:{getuser:["UserService",function(a){return a.getuser()}]}}).when("/findByIngredients",{templateUrl:"/views/templates/findByIngredients.html",controller:"FindByIngController",controllerAs:"recipe",resolve:{getuser:["UserService",function(a){return a.getuser()}]}}).when("/recipeResults",{templateUrl:"/views/templates/recipeResults.html",controller:"FindByIngController",controllerAs:"recipe",resolve:{getuser:["UserService",function(a){return a.getuser()}]}}).when("/recipeDetails",{templateUrl:"/views/templates/recipeDetails.html",controller:"FindByIngController",controllerAs:"recipe",resolve:{getuser:["UserService",function(a){return a.getuser()}]}}).otherwise({redirectTo:"home"})}]),myApp.controller("FindByIngController",["$scope","$http","$location","ApiService","UserService",function(a,b,c,d,e){console.log("FindByIngController loaded");var f=this;f.logout=e.logout,f.ingredient={},f.addIngredient=function(a){console.log("ADDING INGREDIENT",a);var c=a.name;swal(c+" added!",c+" is now available to select in Ingredients List","success"),b.post("/ingredients",a).then(function(a){g(),f.ingredient.name=""})};var g=function(){b.get("/ingredients").then(function(a){f.list=a.data})};g(),a.findRecipes=function(){var b=a.selectedIng;d.getRecipes(b)},f.learnMore=function(a){d.getDetails(a),d.getInstructions(a)},f.infoFromApi=d.infoFromApi,f.detailsFromApi=d.detailsFromApi,f.recipeInstructions=d.recipeInstructions}]),myApp.factory("ApiService",["$http","$sce","$location",function(a,b,c){var d={},e={},f={};return{infoFromApi:d,getRecipes:function(b){a.get("/api/"+b).then(function(a){d.response=a.data,c.path("/recipeResults"),console.log("relevant recipes",a)})},detailsFromApi:e,getDetails:function(d){a.get("/api/detail/"+d).then(function(a){e.response=a.data,e.response.summaryTrusted=b.trustAsHtml(e.response.summary),c.path("/recipeDetails"),console.log("recipe details",a)})},recipeInstructions:f,getInstructions:function(c){a.get("/api/instructions/"+c).then(function(a){f.response=a.data,f.response.summaryTrusted=b.trustAsHtml(f.response.instructions),console.log("recipe instructions",a)})}}}]),myApp.controller("LoginController",["$scope","$http","$location","UserService",function(a,b,c,d){a.user={username:"",password:""},a.message="",a.login=function(){""===a.user.username||""===a.user.password?swal("You forgot to enter something in.","Please enter your username and password.","warning"):b.post("/",a.user).then(function(a){a.data.username?c.path("/user"):(console.log("failure: ",a),swal("Your username or password was incorrect.","Please try again.","warning"))})},a.registerUser=function(){""===a.user.username||""===a.user.password?swal("You forgot to enter something in.","Please choose a username and password.","warning"):b.post("/register",a.user).then(function(a){c.path("/home")},function(a){console.log("error"),swal("Please try again.","warning")})}}]),myApp.controller("navController",["$location","ApiService",function(a,b){var c=this;c.state=a.path(),c.go=function(b){a.path(b)},c.infoFromApi=b.infoFromApi,c.detailsFromApi=b.detailsFromApi}]),myApp.controller("UserController",["$scope","$http","$location","UserService",function(a,b,c,d){a.userObject=d.userObject,a.logout=d.logout}]),myApp.factory("UserService",["$http","$location",function(a,b){var c={};return{userObject:c,getuser:function(){a.get("/user").then(function(a){a.data.username?c.userName=a.data.username:b.path("/home")})},logout:function(){a.get("/user/logout").then(function(a){b.path("/home")})}}}]);